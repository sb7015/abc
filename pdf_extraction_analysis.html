<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LangExtract Performance Benchmark</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #231E33 0%, #500985 100%);
            color: #FFFFFF;
            line-height: 1.6;
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .slide {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            padding: 60px 0;
            opacity: 0;
            transform: translateY(50px);
            animation: slideIn 1s ease-out forwards;
        }

        @keyframes slideIn {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .slide:nth-child(2) { animation-delay: 0.2s; }
        .slide:nth-child(3) { animation-delay: 0.4s; }
        .slide:nth-child(4) { animation-delay: 0.6s; }

        h1 {
            font-size: 3.5rem;
            font-weight: 700;
            text-align: center;
            margin-bottom: 30px;
            background: linear-gradient(45deg, #794CFF, #00BFBA);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        h2 {
            font-size: 2.5rem;
            font-weight: 600;
            margin-bottom: 40px;
            color: #794CFF;
            text-align: center;
            position: relative;
        }

        h2::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 3px;
            background: linear-gradient(90deg, #794CFF, #00BFF5);
        }

        h3 {
            font-size: 1.8rem;
            font-weight: 600;
            margin-bottom: 20px;
            color: #00BFBA;
        }

        .subtitle {
            font-size: 1.3rem;
            text-align: center;
            margin-bottom: 60px;
            color: #EBE4FF;
            opacity: 0.9;
        }

        .two-column {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 60px;
            align-items: start;
        }

        .card {
            background: rgba(121, 76, 255, 0.1);
            border: 1px solid rgba(121, 76, 255, 0.3);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            backdrop-filter: blur(10px);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(121, 76, 255, 0.2);
        }

        .performance-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin: 40px 0;
        }

        .metric-card {
            background: linear-gradient(135deg, #00BFBA 0%, #00BFF5 100%);
            color: #231E33;
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            transform: scale(0.95);
            animation: pulse 2s infinite alternate;
        }

        @keyframes pulse {
            0% { transform: scale(0.95); }
            100% { transform: scale(1); }
        }

        .metric-text {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .metric-label {
            font-size: 1.1rem;
            font-weight: 500;
        }

        .challenge-list {
            list-style: none;
            margin: 30px 0;
        }

        .challenge-list li {
            background: rgba(40, 24, 73, 0.6);
            border-left: 4px solid #794CFF;
            padding: 20px;
            margin-bottom: 15px;
            border-radius: 8px;
            transition: background 0.3s ease;
        }

        .challenge-list li:hover {
            background: rgba(40, 24, 73, 0.8);
        }

        .solution-list {
            list-style: none;
            margin: 30px 0;
        }

        .solution-list li {
            background: rgba(0, 191, 186, 0.1);
            border-left: 4px solid #00BFBA;
            padding: 20px;
            margin-bottom: 15px;
            border-radius: 8px;
        }

        .code-block {
            background: #231E33;
            border: 1px solid #794CFF;
            border-radius: 10px;
            padding: 25px;
            margin: 30px 0;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
            position: relative;
            max-height: 500px;
            overflow-y: auto;
        }

        .code-block::before {
            content: 'Current Implementation Code';
            position: absolute;
            top: -12px;
            left: 20px;
            background: #231E33;
            color: #794CFF;
            padding: 0 10px;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .code-block pre {
            margin: 0;
            color: #EBE4FF;
            font-size: 0.9rem;
            line-height: 1.4;
            white-space: pre-wrap;
        }

        .recommendation-box {
            background: linear-gradient(135deg, #794CFF 0%, #500985 100%);
            border-radius: 15px;
            padding: 40px;
            margin: 40px 0;
            text-align: center;
            box-shadow: 0 20px 40px rgba(121, 76, 255, 0.3);
        }

        .accuracy-comparison {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 30px;
            margin: 40px 0;
        }

        .accuracy-bar {
            background: rgba(40, 24, 73, 0.6);
            border-radius: 10px;
            padding: 25px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .accuracy-bar::before {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: var(--percentage);
            background: linear-gradient(0deg, #00BFBA, #794CFF);
            transition: height 2s ease;
            z-index: 1;
        }

        .accuracy-content {
            position: relative;
            z-index: 2;
        }

        .very-high { --percentage: 90%; }
        .medium { --percentage: 50%; }
        .low { --percentage: 25%; }

        .research-links {
            background: rgba(0, 191, 186, 0.1);
            border: 1px solid #00BFBA;
            border-radius: 10px;
            padding: 25px;
            margin: 30px 0;
        }

        .research-links a {
            color: #00BFF5;
            text-decoration: none;
            font-weight: 500;
        }

        .research-links a:hover {
            text-decoration: underline;
            color: #794CFF;
        }

        .footer {
            text-align: center;
            padding: 40px 0;
            border-top: 1px solid rgba(121, 76, 255, 0.3);
            margin-top: 60px;
            color: #EBE4FF;
        }

        @media (max-width: 768px) {
            .two-column {
                grid-template-columns: 1fr;
                gap: 30px;
            }
            
            h1 { font-size: 2.5rem; }
            h2 { font-size: 2rem; }
            
            .accuracy-comparison {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Title Slide -->
        <div class="slide">
            <h1>LangExtract Performance Benchmark</h1>
            <p class="subtitle">GPT-4o Model Performance Analysis & Scalability Assessment</p>
            <p class="subtitle">Executive Summary • Generated September 2025</p>
            <div class="performance-grid">
                <div class="metric-card">
                    <div class="metric-text">Very High</div>
                    <div class="metric-label">Native PDF Accuracy</div>
                </div>
                <div class="metric-card">
                    <div class="metric-text">Low</div>
                    <div class="metric-label">Scanned Table Accuracy</div>
                </div>
                <div class="metric-card">
                    <div class="metric-text">Medium</div>
                    <div class="metric-label">Scanned Text Accuracy</div>
                </div>
            </div>
        </div>

        <!-- Executive Summary -->
        <div class="slide">
            <h2>Executive Summary</h2>
            <div class="card">
                <p style="font-size: 1.2rem; margin-bottom: 20px;">Our comprehensive benchmark of LangExtract using GPT-4o reveals <strong>very high accuracy and extraction capabilities</strong> with concerning <strong>scalability limitations</strong>. While the system consistently delivers high-quality results across document sizes, processing time increases exponentially with document length, reaching <strong>over 12 minutes for 21k character documents</strong>.</p>
                
                <div style="background: rgba(121, 76, 255, 0.2); padding: 20px; border-radius: 10px; margin: 20px 0;">
                    <h4 style="color: #794CFF; margin-bottom: 10px;">Research Validation:</h4>
                    <p>Community research confirms our findings - LangExtract faces known challenges including "context window limitations when it comes to large documents" and performance degradation. However, the library is specifically engineered to handle large documents efficiently through chunking strategies, parallel processing, and multi-pass scanning, suggesting our current implementation may not be leveraging these advanced features.</p>
                </div>
            </div>
        </div>

        <!-- Key Findings -->
        <div class="slide">
            <h2>Performance Analysis</h2>
            <div class="two-column">
                <div class="card">
                    <h3>✅ Strong Performance Areas</h3>
                    <ul class="solution-list">
                        <li><strong>Native PDFs:</strong> Very high extraction accuracy with structured text preservation</li>
                        <li><strong>Scanned Text:</strong> Medium performance for well-formatted documents</li>
                        <li><strong>Simple Layouts:</strong> Reliable structure recognition and content extraction</li>
                        <li><strong>Clean Documents:</strong> High-resolution sources perform above average</li>
                    </ul>
                </div>
                <div class="card">
                    <h3>⚠️ Performance Limitations</h3>
                    <ul class="challenge-list">
                        <li><strong>Complex Tables:</strong> Below average accuracy for scanned tabular data</li>
                        <li><strong>Low-Quality Scans:</strong> Poor performance with noise/blur artifacts</li>
                        <li><strong>Multi-Column Layouts:</strong> Structure recognition challenges</li>
                        <li><strong>Processing Time:</strong> Exponential scaling with document length</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Technical Analysis -->
        <div class="slide">
            <h2>Technical Challenges Identified</h2>
            
            <div class="accuracy-comparison">
                <div class="accuracy-bar very-high">
                    <div class="accuracy-content">
                        <h3>Native PDF Tables</h3>
                        <div class="metric-text">Very High</div>
                        <p>Structured data preserved</p>
                    </div>
                </div>
                <div class="accuracy-bar medium">
                    <div class="accuracy-content">
                        <h3>Simple Scanned Tables</h3>
                        <div class="metric-text">Medium</div>
                        <p>Basic structure maintained</p>
                    </div>
                </div>
                <div class="accuracy-bar low">
                    <div class="accuracy-content">
                        <h3>Complex Scanned Tables</h3>
                        <div class="metric-text">Low</div>
                        <p>Significant degradation</p>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>Root Cause Analysis</h3>
                <ul class="challenge-list">
                    <li><strong>LangExtract Limitations:</strong> Designed for unstructured text extraction, not optimized for complex table structures from scanned documents</li>
                    <li><strong>OCR Dependencies:</strong> Relies on upstream OCR quality - poor scans lead to text recognition errors that break table boundaries</li>
                    <li><strong>Context Window Issues:</strong> Large documents face known limitations in multi-fact retrieval scenarios across million-token contexts</li>
                    <li><strong>Schema Enforcement:</strong> While excellent for text entities, struggles with preserving spatial relationships in tabular data</li>
                </ul>
            </div>

            <div class="research-links">
                <h4 style="color: #00BERA; margin-bottom: 15px;">Research Findings & Sources:</h4>
                <p><strong>LangExtract Official Documentation:</strong> <a href="https://github.com/google/langextract" target="_blank">GitHub Repository</a> | <a href="https://developers.googleblog.com/en/introducing-langextract-a-gemini-powered-information-extraction-library/" target="_blank">Google Developer Blog</a></p>
                <p><strong>Performance Studies:</strong> <a href="https://towardsdatascience.com/extracting-structured-data-with-langextract-a-deep-dive-into-llm-orchestrated-workflows/" target="_blank">LLM-Orchestrated Workflows Analysis</a> | <a href="https://nanonets.com/blog/table-extraction-using-llms-unlocking-structured-data-from-documents/" target="_blank">Table Extraction Challenges</a></p>
                <p><strong>Benchmark Comparisons:</strong> <a href="https://procycons.com/en/blogs/pdf-data-extraction-benchmark/" target="_blank">PDF Data Extraction Benchmark 2025</a></p>
            </div>
        </div>

        <!-- Current Implementation Analysis -->
        <div class="slide">
            <h2>Current Implementation Analysis</h2>
            
            <div class="code-block">
<pre>
import os
import textwrap
import pathlib as pl
import pandas as pd
import langextract as lx

# Set up SSL certificates if needed
os.environ['SSL_CERT_FILE'] = os.path.join(os.getcwd(), "root.pem")
os.environ['REQUESTS_CA_BUNDLE'] = os.path.join(os.getcwd(), "root.pem")

# 🔧 Set your markdown filename here
markdown_filename = "extracted_pages_combined.md"
md_file = pl.Path(markdown_filename)
if not md_file.exists():
    raise FileNotFoundError(f"File not found: {md_file.resolve()}")

# 📌 Prompt and few-shot example
prompt = textwrap.dedent("""\
    The input is a Markdown file that contains one or more tables (pipe-delimited or GitHub-flavoured).
    1. Locate the primary data table (ignore layout or TOC tables).
    2. Use the header row to determine the column names.
    3. Return one extraction per data row (skip the header itself).
    4. extraction_class must be "table_row".
    5. extraction_text must be the raw text of the first cell in that row.
    6. attributes must be a dict whose keys are the exact column headers.
    7. Preserve original wording; do not paraphrase.
    8. If a cell is empty, store an empty string as value.
    9. Emit rows in the same order they appear in the Markdown.
""")

examples = [
    lx.data.ExampleData(
        text=textwrap.dedent("""\
            | Planet  | Distance (AU) | Radius (km) | Moons |
            |---------|---------------|-------------|-------|
            | Earth   | 1.0           | 6371        | 1     |
            | Mars    | 1.52          | 3390        | 2     |
        """),
        extractions=[
            lx.data.Extraction(
                extraction_class="table_row",
                extraction_text="Earth",
                attributes={
                    "Planet": "Earth",
                    "Distance (AU)": "1.0",
                    "Radius (km)": "6371",
                    "Moons": "1"
                }
            ),
            lx.data.Extraction(
                extraction_class="table_row",
                extraction_text="Mars",
                attributes={
                    "Planet": "Mars",
                    "Distance (AU)": "1.52",
                    "Radius (km)": "3390",
                    "Moons": "2"
                }
            ),
        ]
    )
]

# 📄 Read the Markdown file
markdown_text = md_file.read_text(encoding="utf-8")

# 🧠 LangExtract call
result = lx.extract(
    text_or_documents=markdown_text,
    prompt_description=prompt,
    examples=examples,
    model_id="gpt-4o",
    api_key="hclXrQFZfwREJigLbW6wKu3ao68Bwyk6",
    model_url="https://api.horizon.elevancehealth.com/openai/v1"
)

# 📊 Convert extractions to DataFrame
rows = []
for ext in result.extractions:
    row = {"Class": ext.extraction_class, "Text": ext.extraction_text}
    if ext.attributes:
        row.update(ext.attributes)
    rows.append(row)

df = pd.DataFrame(rows)
df_clean = df.drop(columns=["Class", "Text"])
df_clean.to_excel(md_file.with_suffix(".xlsx"), index=False)
df_clean.to_html(md_file.with_suffix(".html"), index=False)

print(f"✅ Done! Files saved as:")
print(f"→ {md_file.with_suffix('.xlsx').resolve()}")
print(f"→ {md_file.with_suffix('.html').resolve()}")
</pre>
            </div>

            <div class="two-column">
                <div class="card">
                    <h3>Implementation Strengths</h3>
                    <ul class="solution-list">
                        <li>Well-structured prompt engineering with clear instructions</li>
                        <li>Robust few-shot learning examples for GPT-4o</li>
                        <li>Clean output to Excel/HTML formats</li>
                        <li>Good error handling and file validation</li>
                        <li>Proper SSL certificate configuration</li>
                    </ul>
                </div>
                <div class="card">
                    <h3>Key Limitations</h3>
                    <ul class="challenge-list">
                        <li>Single extraction method regardless of PDF source type</li>
                        <li>No pre-processing for scan quality assessment</li>
                        <li>OCR → Markdown conversion loses spatial table relationships</li>
                        <li>Missing LangExtract's advanced chunking and parallel processing features</li>
                        <li>No document classification (native vs. scanned)</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Final Summary -->
        <div class="slide">
            <h2>Final Summary</h2>
            
            <div class="recommendation-box">
                <h3>Key Takeaway</h3>
                <p>LangExtract excels with native PDFs and simple text extraction but shows significant limitations for complex table extraction from scanned sources. Current implementation underutilizes advanced LangExtract features.</p>
            </div>

            <div class="card">
                <h3>Research Findings</h3>
                <ul class="solution-list">
                    <li>LangExtract is primarily designed for unstructured text, not complex table structures</li>
                    <li>Processing time scales exponentially with document length</li>
                    <li>OCR quality dependencies significantly impact table extraction accuracy</li>
                    <li>Advanced features like parallel processing not fully implemented</li>
                </ul>
            </div>

            <div class="card">
                <h3>Risk Assessment</h3>
                <ul class="challenge-list">
                    <li>Current pipeline may not scale for high-volume document processing</li>
                    <li>Complex scanned tables require alternative processing approaches</li>
                    <li>Performance degradation with large document sets</li>
                </ul>
            </div>
        </div>
    </div>

    <div class="footer">
        <p>Prepared for Management Review | LangExtract Performance Analysis | September 2025</p>
    </div>

    <script>
        // Add smooth scrolling and progressive enhancement
        document.addEventListener('DOMContentLoaded', function() {
            // Stagger slide animations
            const slides = document.querySelectorAll('.slide');
            slides.forEach((slide, index) => {
                slide.style.animationDelay = `${index * 0.2}s`;
            });

            // Add interactive hover effects
            const cards = document.querySelectorAll('.card');
            cards.forEach(card => {
                card.addEventListener('mouseenter', function() {
                    this.style.transform = 'translateY(-8px) scale(1.02)';
                });
                card.addEventListener('mouseleave', function() {
                    this.style.transform = 'translateY(0) scale(1)';
                });
            });

            // Animate accuracy bars on scroll
            const observerOptions = {
                threshold: 0.5,
                rootMargin: '0px 0px -50px 0px'
            };

            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const bars = entry.target.querySelectorAll('.accuracy-bar');
                        bars.forEach(bar => {
                            bar.style.animation = 'none';
                            bar.offsetHeight; // Trigger reflow
                            bar.style.animation = 'pulse 2s infinite alternate';
                        });
                    }
                });
            }, observerOptions);

            document.querySelectorAll('.accuracy-comparison').forEach(section => {
                observer.observe(section);
            });
        });
    </script>
</body>
</html>